<!DOCTYPE HTML>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="/static/css/colorful.css">
    <link rel="Stylesheet" type="text/css" href="/static/css/style.css">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="alternate" type="application/atom+xml" href="atom.xml" title="Atom feed">
    <title>Jenkins Pipeline Cheatsheet - Wiki &bull; Phixyn</title>
    <meta name="keywords" content="personal, wiki, stuff"/>
    <meta name="description" content="Phixyn's Personal Wiki \o/"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
  </head>

  <body>
    <div id="container" class="typo">
      
<div id="header">
  <div id="post-nav">
    <a href="/">Wiki &bull; Phixyn</a>
    &nbsp;&#187;&nbsp;
    <a href="/#continuous-integration">continuous-integration</a>
    &nbsp;&#187;&nbsp;Jenkins Pipeline Cheatsheet
    <span class="updated">Updated&nbsp;
    2020-01-20 22:11
    </span>
  </div>
</div>
<div class="clearfix"></div>
<div id="content">
  <h1 id="jenkins-pipeline-cheatsheet">Jenkins Pipeline Cheatsheet</h1>
<ul>
<li><a href="#archiving-artifacts">Archiving Artifacts</a></li>
<li><a href="#variables">Variables</a></li>
<li><a href="#global-variables">Global Variables</a></li>
<li><a href="#environment-variables">Environment Variables</a></li>
<li><a href="#storing-shell-stdout-values">Storing shell STDOUT values</a></li>
<li><a href="#triggers">Triggers</a></li>
<li><a href="#conditional-triggers">Conditional Triggers</a></li>
</ul>
<h2 id="archiving-artifacts">Archiving Artifacts</h2>
<div class="hlcode"><pre><span class="n">archiveArtifacts</span> <span class="nl">artifacts:</span> <span class="s2">&quot;**/${env.RESULTS_ARCHIVE}&quot;</span>
</pre></div>


<p><em><strong>Note:</strong> Always use double quotes with string interpolation.</em></p>
<h2 id="variables">Variables</h2>
<h3 id="global-variables">Global Variables</h3>
<div class="hlcode"><pre><span class="n">VAR</span><span class="o">=</span><span class="s2">&quot;value&quot;</span>
<span class="n">pipeline</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>


<p>Global and mutable variables need to be outside of the pipeline.</p>
<h3 id="environment-variables">Environment Variables</h3>
<div class="hlcode"><pre><span class="n">pipeline</span> <span class="o">{</span>
    <span class="n">environment</span> <span class="o">{</span>
        <span class="n">VAR</span><span class="o">=</span><span class="s2">&quot;VALUE&quot;</span>
    <span class="o">}</span>
    <span class="n">stage</span> <span class="o">{</span>
        <span class="n">steps</span> <span class="o">{</span>
            <span class="n">VAR</span> <span class="o">=</span> <span class="s2">&quot;NEW VALUE&quot;</span>  <span class="c1">// won&#39;t work</span>
            <span class="n">withEnv</span><span class="o">([</span><span class="s1">&#39;VAR=&quot;NEW NEW VALUE&quot;&#39;</span><span class="o">])</span> <span class="o">{</span>
                <span class="c1">// VAR will only be &quot;NEW NEW VALUE&quot; in this block</span>
                <span class="c1">// Not helpful for setting a global to be used later</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>Environment variables can only be modified temporarily with a <code>withEnv</code> block.</p>
<h3 id="storing-shell-stdout-values">Storing shell STDOUT values</h3>
<div class="hlcode"><pre><span class="kt">def</span> <span class="n">var</span> <span class="o">=</span> <span class="n">sh</span><span class="o">([</span><span class="nl">script:</span> <span class="s2">&quot;echo &#39;Variable value&#39;&quot;</span><span class="o">,</span> <span class="nl">returnStdout:</span> <span class="kc">true</span><span class="o">]).</span><span class="na">trim</span><span class="o">()</span>
</pre></div>


<h2 id="triggers">Triggers</h2>
<h3 id="conditional-triggers">Conditional Triggers</h3>
<div class="hlcode"><pre><span class="n">pipeline</span> <span class="o">{</span>
    <span class="n">agent</span> <span class="s2">&quot;your-agent&quot;</span>
    <span class="n">triggers</span> <span class="o">{</span>
        <span class="n">cron</span><span class="o">(</span><span class="n">env</span><span class="o">.</span><span class="na">BRANCH_NAME</span> <span class="o">==</span> <span class="s2">&quot;master&quot;</span> <span class="o">?</span> <span class="s2">&quot;0 23 * * *&quot;</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="o">)</span>
    <span class="o">}</span>
    <span class="n">stage</span> <span class="o">{</span>
        <span class="c1">// ...</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>Triggers a build on the <code>master</code> branch every night at 23:00. A build will only be triggered for the <code>master</code> branch, and no other branches in a multibranch pipeline.</p>
<p><em>See also:</em><br />
<em> <a href="https://issues.jenkins-ci.org/browse/JENKINS-42643?focusedCommentId=293221#comment-293221">Source</a><br />
</em> <a href="https://crontab.guru/">crontab guru</a></p>
  
</div>
    </div>
    <div id="footer">
      <div class="footer-left">
        <p>
        Copyright Â© 2020 Phixyn.
        Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.
        Theme by <a href="https://github.com/tankywoo/yasimple_x2" target="_blank">YASimple_X2</a>.
        </p>
      </div> <!-- end footer-left -->
      <div class="footer-right">
        <p>Site Generated 2020-01-20 23:31:44</p>
      </div> <!-- end footer-right -->
    </div>

    
    
  </body>
</html>